<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MMI Mini-Games - Kawaii Compilation</title>
    
    <!-- Google Fonts -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Fredoka:wght@400;600&family=Rubik+Mono+One&family=Lexend:wght@300;400;500;600;700;800&display=swap" rel="stylesheet">
    
    <link rel="stylesheet" href="./styles.css">
    
    <!-- P5.js et P5play via CDN -->
    <script src="https://cdn.jsdelivr.net/npm/p5@1.11.4/lib/p5.js"></script>
    <script src="https://p5play.org/v3/planck.min.js"></script>
    <script src="https://p5play.org/v3/p5play.js"></script>
    
    <!-- ML5.js via CDN -->
    <script src="https://unpkg.com/ml5@latest/dist/ml5.min.js"></script>
    
    <style>
        /* Configuration des polices menu */
        
        /* Effet de grain pour le fond */
        .bg-grain {
            background-color: #F2F0E9;
            background-image: url("data:image/svg+xml,%3Csvg viewBox='0 0 200 200' xmlns='http://www.w3.org/2000/svg'%3E%3Cfilter id='noiseFilter'%3E%3CfeTurbulence type='fractalNoise' baseFrequency='0.65' numOctaves='3' stitchTiles='stitch'/%3E%3C/filter%3E%3Crect width='100%25' height='100%25' filter='url(%23noiseFilter)' opacity='0.05'/%3E%3C/svg%3E");
        }
    </style>
</head>
<body class="overflow-hidden">
    <!-- Container principal -->
    <div id="app" class="relative w-full h-screen flex flex-col">
        
        <!-- Écran de chargement -->
        <div id="loading-screen" class="absolute inset-0 flex flex-col items-center justify-center bg-grain z-50">
            <h1 class="text-6xl font-display text-black mb-4">MMI Mini-Games</h1>
            <p class="text-2xl text-black/70 font-body animate-pulse">Loading...</p>
        </div>

        <!-- Menu principal -->
        <div id="menu-screen" class="hidden absolute inset-0 bg-grain flex flex-col items-center justify-center z-40 p-4 overflow-hidden">
            <!-- Blobs décoratifs (images) -->
            <img src="./assets/RoundedShapeBackground.png" alt="" class="absolute bottom-0 left-0 w-200 h-200 -translate-x-1/4 translate-y-1/4 z-0 pointer-events-none" />

            <img src="./assets/PurpleStarBackground.png" alt="" class="absolute top-0 right-0 w-200 h-200 translate-x-1/4 -translate-y-1/4 z-0 pointer-events-none" />

            <main class="relative z-10 w-full max-w-2xl flex flex-col items-center gap-8">
                <!-- Bouton Play principal -->
                <button id="btn-start" class="w-full bg-[#FFB347] rounded-full py-4 px-8 shadow-sm border-b-4 border-[#E59A30] transform hover:scale-[1.02] transition-transform duration-200 cursor-pointer">
                    <h1 class="text-4xl md:text-5xl text-black text-center font-display tracking-tighter uppercase">
                        Play
                    </h1>
                </button>

                <!-- Grille des jeux -->
                <div id="gallery-games" class="grid grid-cols-1 md:grid-cols-2 gap-6 w-full">
                    <!-- Les jeux seront ajoutés dynamiquement par main.js -->
                </div>
            </main>

            <!-- Bouton Leaderboard flottant -->
            <button id="btn-leaderboard" class="fixed bottom-6 right-6 md:bottom-10 md:right-10 bg-[#FFB347] p-4 rounded-full shadow-lg border-b-4 border-[#E59A30] hover:scale-110 transition-transform z-20">
                <svg width="69" height="69" viewBox="0 0 69 69" fill="none" xmlns="http://www.w3.org/2000/svg">
                    <path d="M34.5 31.625C36.0812 31.625 37.4354 31.0625 38.5624 29.9374C39.6894 28.8123 40.2519 27.4582 40.25 25.875C40.2481 24.2918 39.6855 22.9387 38.5624 21.8155C37.4392 20.6923 36.0851 20.1288 34.5 20.125C32.9149 20.1212 31.5618 20.6847 30.4405 21.8155C29.3193 22.9463 28.7558 24.2995 28.75 25.875C28.7442 27.4505 29.3078 28.8046 30.4405 29.9374C31.5733 31.0701 32.9264 31.6327 34.5 31.625ZM20.125 60.375V54.625H31.625V45.7125C29.2771 45.1854 27.1812 44.1916 25.3374 42.7311C23.4935 41.2706 22.1394 39.4373 21.275 37.2312C17.6813 36.8 14.675 35.2312 12.2561 32.5249C9.83729 29.8185 8.62692 26.6436 8.625 23V20.125C8.625 18.5437 9.1885 17.1906 10.3155 16.0655C11.4425 14.9404 12.7957 14.3769 14.375 14.375H20.125V8.625H48.875V14.375H54.625C56.2062 14.375 57.5604 14.9385 58.6874 16.0655C59.8144 17.1925 60.3769 18.5457 60.375 20.125V23C60.375 26.6417 59.1646 29.8166 56.7439 32.5249C54.3231 35.2331 51.3168 36.8019 47.725 37.2312C46.8625 39.4354 45.5093 41.2687 43.6655 42.7311C41.8217 44.1935 39.7248 45.1873 37.375 45.7125V54.625H48.875V60.375H20.125ZM20.125 31.05V20.125H14.375V23C14.375 24.8208 14.9021 26.4625 15.9563 27.9249C17.0104 29.3873 18.4 30.429 20.125 31.05ZM34.5 40.25C36.8958 40.25 38.9323 39.4115 40.6094 37.7344C42.2865 36.0573 43.125 34.0208 43.125 31.625V14.375H25.875V31.625C25.875 34.0208 26.7135 36.0573 28.3906 37.7344C30.0677 39.4115 32.1042 40.25 34.5 40.25ZM48.875 31.05C50.6 30.4271 51.9896 29.3844 53.0438 27.922C54.0979 26.4596 54.625 24.8189 54.625 23V20.125H48.875V31.05Z" fill="black"/>
                </svg>


            </button>
        </div>

        <!-- Écran de tutoriel -->
        <div id="tutorial-screen" class="hidden absolute inset-0 flex flex-col items-center justify-center bg-background z-30 p-8">
            <div class="max-w-2xl bg-white rounded-3xl shadow-2xl p-8 border-4 border-primary">
                <h2 id="tutorial-title" class="text-4xl font-climate-crisis font-bold text-primary mb-6 text-center">
                    Tutorial
                </h2>
                <div id="tutorial-content" class="text-xl text-text mb-8 space-y-4">
                    <!-- Dynamic content -->
                </div>
                <button id="btn-start-game" class="w-full px-8 py-4 bg-secondary text-text text-2xl font-climate-crisis font-bold rounded-full hover:scale-105 transition-transform">
                    Start
                </button>
            </div>
        </div>

        <!-- Zone de jeu (canvas P5.js) -->
        <div id="game-container" class="hidden relative flex-1 w-full h-full">
            <!-- Le canvas P5.js sera inséré ici -->
            
            <!-- HUD bas de l'écran (Score, Numéro de jeu, Retour menu) -->
            <div id="game-hud-bottom" class="absolute bottom-4 left-0 right-0 flex justify-center items-center gap-8 px-8 z-10">
                <div class="bg-white/90 rounded-2xl px-8 py-4 border-3  shadow-lg">
                    <span class="block text-sm text-text opacity-70 text-center mb-1">Score</span>
                    <p id="score-display" class="text-4xl font-climate-crisis font-bold text-primary text-center">0</p>
                </div>
                <div class="bg-white/90 rounded-2xl px-8 py-4 border-3  shadow-lg">
                    <span class="block text-sm text-text opacity-70 text-center mb-1">Mini-Game</span>
                    <p id="level-display" class="text-4xl font-climate-crisis font-bold text-secondary text-center">1</p>
                </div>
                <button id="btn-hud-menu" class="ml-4 px-6 py-4 bg-secondary text-text text-xl font-climate-crisis font-bold rounded-full hover:scale-110 transition-transform border-2 border-primary shadow-lg">
                    ⬅️ Menu
                </button>
            </div>
        </div>

        <!-- Écran de transition -->
        <div id="transition-screen" class="hidden absolute inset-0 flex flex-col items-center justify-center bg-background z-30">
            <h2 class="text-5xl font-climate-crisis font-bold text-primary mb-4 kawaii-bounce">
                Well Done!
            </h2>
            <p id="transition-text" class="text-2xl text-text mb-8">
                <!-- Dynamic text -->
            </p>
            <div class="text-6xl kawaii-pulse">...</div>
        </div>

        <!-- Écran Game Over -->
        <div id="gameover-screen" class="hidden absolute inset-0 flex flex-col items-center justify-center bg-background z-30">
            <h2 class="text-6xl font-climate-crisis font-bold text-primary mb-6">
                Game Over
            </h2>
            <div class="bg-white rounded-3xl shadow-2xl p-8 border-4 border-primary mb-8">
                <p class="text-xl text-text mb-4">Final Score</p>
                <p id="final-score" class="text-6xl font-climate-crisis font-bold text-secondary text-center mb-6">0</p>
                
                <!-- Pseudo input -->
                <div class="flex flex-col gap-3">
                    <input 
                        type="text" 
                        id="pseudo-input" 
                        placeholder="Enter your nickname" 
                        maxlength="20"
                        class="px-4 py-3 text-xl text-center rounded-2xl border-2 border-primary focus:outline-none focus:border-secondary transition-colors"
                    />
                    <button id="btn-save-score" class="px-6 py-3 bg-lime text-text text-xl font-climate-crisis font-bold rounded-2xl hover:scale-105 transition-transform">
                        Save Score
                    </button>
                    <p id="save-message" class="text-sm text-center h-6"></p>
                </div>
            </div>
            <div class="flex gap-4">
                <button id="btn-restart" class="px-8 py-4 bg-primary text-white text-2xl font-climate-crisis font-bold rounded-full hover:scale-110 transition-transform">
                    Play Again
                </button>
                <button id="btn-menu" class="px-8 py-4 bg-secondary text-text text-2xl font-climate-crisis font-bold rounded-full hover:scale-110 transition-transform">
                    Menu
                </button>
            </div>
        </div>

        <!-- Écran de classement -->
        <div id="leaderboard-screen" class="hidden absolute inset-0 flex flex-col items-center justify-center bg-background z-40 p-8">
            <div class="max-w-3xl w-full bg-white rounded-3xl shadow-2xl p-8 border-4 border-primary">
                <h2 class="text-5xl font-climate-crisis font-bold text-primary mb-8 text-center">
                    Leaderboard
                </h2>
                
                <!-- Leaderboard list -->
                <div id="leaderboard-list" class="space-y-3 mb-8 max-h-96 overflow-y-auto overflow-x-hidden">
                    <!-- Dynamic loading -->
                </div>
                
                <button id="btn-back-menu" class="w-full px-8 py-4 bg-secondary text-text text-2xl font-climate-crisis font-bold rounded-full hover:scale-105 transition-transform">
                    Back to Menu
                </button>
            </div>
        </div>
    </div>

    <!-- Scripts -->
    <script type="module" src="./main.js"></script>
</body>
</html>
